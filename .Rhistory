test=1
test
test <- read.csv("https://raw.githubusercontent.com/govex/COVID-19/master/data_tables/vaccine_data/global_data/time_series_covid19_vaccine_global.csv")
View(test)
vaccines <- read.csv("https://raw.githubusercontent.com/govex/COVID-19/master/data_tables/vaccine_data/global_data/time_series_covid19_vaccine_global.csv")
View(vaccines)
if (!requireNamespace("BiocManager", quietly = TRUE))
install.packages("BiocManager")
for (pkg in c("GEOquery", "oligo", "limma", "hgu133plus2.db", "pd.hg.u133.plus.2", "viridis", "fgsea")) {
if (!requireNamespace(pkg, quietly = TRUE)) {
BiocManager::install(pkg)
}
}
for (pkg in c("gplots")) {
if (!requireNamespace(pkg, quietly = TRUE)) {
install.packages(pkg)
}
}
library(BiocManager)
library(GEOquery)
library(oligo)
library(limma)
library(viridis)
# Download raw CEL files from GEO
if (!file.exists("./GSE183621/GSE183621_RAW.tar"))
getGEOSuppFiles("GSE183621")
# Create expression set and define phenotype variable
untar("./GSE183621/GSE183621_RAW.tar", exdir = "./GSE183621/data")
celFiles <- list.celfiles("./GSE183621/data", full.names = TRUE, listGzipped = TRUE)
raw.data <- read.celfiles(celFiles)
pData(raw.data)$treatment <- c(rep(c("Naive", "lineage A", "lineage B.1.3", "lineage B.1.1.7", "lineage B.1.351")))
# Create expression set and define phenotype variable
untar("./GSE183621/GSE183621_RAW.tar", exdir = "./GSE183621/data")
celFiles <- list.celfiles("./GSE183621/data", full.names = TRUE, listGzipped = TRUE)
raw.data <- read.celfiles(celFiles)
pData(raw.data)$treatment <- c(rep(c("Naive", "lineage A", "lineage B.1.3", "lineage B.1.1.7", "lineage B.1.351")))
raw.data <- read.celfiles(celFiles)
celFiles <- list.celfiles("./GSE183621/data", full.names = TRUE, listGzipped = TRUE)
raw.data <- read.celfiles(celFiles)
if (!file.exists("./GSE27973/GSE27973_RAW.tar"))
getGEOSuppFiles("GSE27973")
if (!file.exists("./GSE27973/GSE27973_RAW.tar"))
getGEOSuppFiles("GSE27973")
untar("./GSE27973/GSE27973_RAW.tar", exdir = "./GSE27973/data")
celFiles <- list.celfiles("./GSE27973/data", full.names = TRUE, listGzipped = TRUE)
celFiles
untar("./GSE183621/GSE183621_RAW.tar", exdir = "./GSE183621/data")
celFiles <- list.celfiles("./GSE183621/data", full.names = TRUE, listGzipped = TRUE)
read.delim(GSE183621_Fold_change.txt)
read.delim(file = GSE183621_Fold_change.txt)
read.table(file = GSE183621_Fold_change.txt)
test <- read.table("https://raw.githubusercontent.com/roopshab/BMIN503_Final_Project/master/GSE183621_Fold_change.txt")
test <- read.table("https://raw.githubusercontent.com/roopshab/BMIN503_Final_Project/master/GSE183621_Fold_change.txt", fill = TRUE)
View(test)
test <- read.table("https://raw.githubusercontent.com/roopshab/BMIN503_Final_Project/master/GSE183621_Fold_change.txt", fill = TRUE, header = FALSE)
View(test)
View(test)
covidExpression <- read.table("https://raw.githubusercontent.com/roopshab/BMIN503_Final_Project/master/GSE183621_Fold_change.txt", fill = TRUE, header = FALSE)
View(vaccines)
View(covidExpression)
# Download raw CEL files from GEO
https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE120615
if (!file.exists("./GSE120615/GSE120615_RAW.tar"))
getGEOSuppFiles("GSE120615")
# Create expression set and define phenotype variable
untar("./GSE120615/GSE120615_RAW.tar", exdir = "./GSE120615/data")
celFiles <- list.celfiles("./GSE120615/data", full.names = TRUE, listGzipped = TRUE)
raw.data <- read.celfiles(celFiles)
pData(raw.data)$treatment <- c(rep(c("Control", "2H", "16H")))
# Look at a boxplot of expression values for each sample and see whether any seem to be outliers.
boxplot(raw.data, col = "red", main = "Raw Probe Intensities")
# Perform RMA on the samples
GSE120615.rma <- rma(raw.data)
# Create a new intensity boxplot
boxplot(GSE120615.rma, col = "blue", main = "RMA Expression Values")
library(ggplot2)
library(dplyr)
# Create a model matrix
GSE120615.rma <- rma(raw.data)
design <- model.matrix(~ -1 + factor(GSE120615.rma$treatment))
colnames(design) <- levels(factor(GSE120615.rma$treatment))
# Fit a linear model with limma package. Expression data linked to outcome of a design matrix model
fit <- lmFit(GSE120615.rma, design)
# Create contrast groups of interest - control vs. 2H
GSE120615.contrast.1 <- makeContrasts(treatment = Control - 2H, levels = design)
# Create expression set and define phenotype variable
untar("./GSE120615/GSE120615_RAW.tar", exdir = "./GSE120615/data")
celFiles <- list.celfiles("./GSE120615/data", full.names = TRUE, listGzipped = TRUE)
raw.data <- read.celfiles(celFiles)
pData(raw.data)$treatment <- c(rep(c("Control", "2Hours", "16Hours")))
# Look at a boxplot of expression values for each sample and see whether any seem to be outliers.
boxplot(raw.data, col = "red", main = "Raw Probe Intensities")
# Perform RMA on the samples
GSE120615.rma <- rma(raw.data)
# Look at a boxplot of expression values for each sample and see whether any seem to be outliers.
boxplot(raw.data, col = "red", main = "Raw Probe Intensities")
